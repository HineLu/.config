"use strict";var t,u,s,w,y,x,O,S,R,N,_,J,P;"".includes||(function(){var t=String.prototype;"".startsWith||(t.startsWith=function(t){return 0===this.lastIndexOf(t,0)},t.endsWith=function(t){var n=this.length-t.length;return n>=0&&this.indexOf(t,n)===n}),t.includes=function(t,n){return this.indexOf(t,n)>=0}})(),t=function(t){return document.querySelector(t)},u=chrome.extension.getBackgroundPage(),s=chrome.i18n.getMessage,w=document.querySelectorAll.bind(document),(y=chrome.i18n.getMessage("lang1"))&&(function(){var n,i,e,u,o=s("keyMappingsP"),r=t("#keyMappings");for(o&&r&&(r.placeholder=o),n=0,i=w("[data-i]");n<i.length;n++)(r=i[n]).innerText=o=s(r.dataset.i);for(e=0,u=w("[data-i-t]");e<u.length;e++)(o=s((r=u[e]).dataset.iT))&&(r.title=o);document.documentElement.lang=y,(o=s("vOptions"))&&(document.title=o)})(),x=function(t,n){var i=function(){this.constructor=t};i.prototype=n.prototype,t.prototype=new i},O=(function(){var t=[],n=function(){var i,e,u=t.length;for(i=0,e=t;i<e.length;i++)(0,e[i])();t.length>u?(t.splice(0,u),Promise.resolve().then(n)):t.length=0};return function(i,e){t.length<=0&&Promise.resolve().then(n),9===e?t.unshift(i):t.push(e?i.bind(null,e):i)}})(),S=function(t,n,i,e){var u,o=0,r=function(){var s=Date.now()-u;if(!(s<n-4&&s>=0))return o=0,u!==e?t.call(i):void 0;o=setTimeout(r,n-s)};return e=e?1:0,function(){if(u=Date.now(),!o)return o=setTimeout(r,n),e?(e=u,t.call(i)):void 0}},R=u.f,N=u.l,_=(function(){function t(t,n){this.lu=t,this.th=t.id,this.gl=this.nh=null,this.ih=false,this.th in N.Rc&&(n=this.eh.bind(this,n)),this.nh=S(n,330,this,1)}return t.prototype.uh=function(){},t.prototype.oh=function(){this.ih=true,this.gl=N.Sc(this.th),t.rh||this.sh(this.gl)},t.prototype.fh=function(t,n,i){var e=this.ah;return n?(i=e||!i?JSON.stringify(e?e.hh(t):t):i,u.JSON.parse(i)):e?e.hh(t):t},t.prototype.lh=function(){return true},t.prototype.dh=function(){var n=this.vh(),i="object"==typeof n,e=i?JSON.stringify(this.gl):this.gl,u=i?JSON.stringify(n):n;u!==e&&(e=u,n=this.fh(n,i,i?u:""),i&&(u=JSON.stringify(n))===JSON.stringify(N.Tc[this.th])&&(n=N.Tc[this.th]),N.xc(this.th,n),this.gl=n=N.Sc(this.th),this.ih=true,e!==(i?JSON.stringify(n):n)&&this.sh(n,true),this.th in N.Rc&&t.ph.push(this.th),this.uh())},t.mh=function(t,n){return JSON.stringify(t)===JSON.stringify(n)},t.wh=Object.create(null),t.rh=true,t})(),J=(function(n){function i(e,u){var o=n.call(this,e,u)||this;return o.gh=_.mh,o.yh=false,N.Dc("exclusionTemplate",function(){var n,e,u,r,c,f,a,h=document.createElement("div");if(h.innerHTML=N._.exclusionTemplate,o.N=h.querySelector("#exclusionTemplate").content.firstChild,y){for(n=void 0,e=void 0,u=0,r=h.querySelectorAll("[data-i]");u<r.length;u++)(e=s((n=r[u]).dataset.i))&&(n.innerText=e);for(c=0,f=o.N.querySelectorAll("[title]");c<f.length;c++)(e=s((n=f[c]).title))&&(n.title=e)}o.xh=h.querySelector("tbody"),o.U_=[],o.xh.addEventListener("input",i.Oh),o.xh.addEventListener("input",o.nh),o.xh.addEventListener("click",function(t){return o.bh(t)}),t("#exclusionAddButton").onclick=function(){return o.kh("")},(a=h.firstElementChild).remove(),o.N.remove(),_.ph&&(o.N.draggable=true),o.yh=true,o.ih&&O(function(){return o.sh(o.gl)}),O(function(t){return o.lu.appendChild(t)},a),O(function(){return o.Sh&&o.Sh()})}),o}return x(i,n),i.prototype.Rh=function(){},i.Oh=function(t){var n=t.target.vnode;n&&(n.Nh=true)},i.prototype.kh=function(t,n){this._h(this.xh,{pattern:t,passKeys:""});var i=this.U_[this.U_.length-1];false!==n&&O(function(){return i.Jh.focus()}),t&&this.nh(),this.Rh(1)},i.prototype.sh=function(t){if(this.yh){if(this.xh.textContent="",this.U_=[],t.length<=0);else if(1===t.length)this._h(this.xh,t[0]);else{var n=document.createDocumentFragment();t.forEach(this._h.bind(this,n)),this.xh.appendChild(n)}return this.Rh(t.length)}},i.prototype.Ph=function(){return true},i.prototype._h=function(t,n){var i,e,u,o,r,s=n.pattern,c=n.passKeys,f={Th:{pattern:s,passKeys:c},Nh:false,vf:false,Jh:null,$h:null};this.Ph(s)?(e=(i=document.importNode(this.N,true)).querySelector(".pattern"),u=i.querySelector(".passKeys"),o=c.trimRight(),e.value=s,s&&(e.placeholder=""),u.value=o,o&&(u.placeholder=""),(r=f).vf=true,r.Jh=e,r.$h=u,e.vnode=r,u.vnode=r,this.U_.push(r),t.appendChild(i)):this.U_.push(f)},i.jh=function(t){t.Th.pattern&&t.$h.placeholder&&(t.$h.placeholder="")},i.prototype.bh=function(t){var n,i=t.target;if(i.classList.contains("exclusionRemove"))return(i=i.parentNode.parentNode).classList.contains("exclusionRule")?(n=i.querySelector(".pattern").vnode,i.remove(),this.U_.splice(this.U_.indexOf(n),1),this.nh(),this.Rh(0)):void 0},i.prototype.vh=function(t){var n,i,e,o,r,s,c,f,a,h,l=[];for(t=true===t,n=0,i=this.U_;n<i.length;n++)e=i[n],t&&!e.vf||(e.Nh?(o=e.Jh.value.trim(),r=false,s=e.$h.value,o?((c=o.startsWith(":")?0:o.indexOf("://"))&&(/^[\^*]|[^\\][$()*+?\[\]{|}]/.test(o)?o.startsWith("^")||(r=!o.includes("/",c+3),o=(c<0?"^https?://":"^")+(o.startsWith("*")&&"."!==o[1]?"[^/]"+o:(o=o.replace(/\./g,"\\.")).startsWith("*")?o.replace("*\\.","(?:[^./]+\\.)*?"):o.replace("://*\\.","://(?:[^./]+\\.)*?"))):(r=!o.includes("/",c+3)&&!o.startsWith("vimium:"),o=(c<0?":http://":":")+(o=o.replace(/\\(.)/g,"$1")))),r&&(o+="/"),s&&((f=(s=u.r.rc(s)).match(/<(?!<)(?:a-)?(?:c-)?(?:m-)?(?:s-)?(?:[a-z][\da-z]+|[^\sA-Z])>|\S/g))&&((a="^"===f[0]&&f.length>1)&&f.shift(),f.sort(),a?f.unshift("^"):"^"===f[0]&&(f.shift(),f.push("^"))),s=(s=f?f.join(" ")+" ":"").replace(/<escape>/gi,"<esc>")),e.$h.title!==(h=s?s.length>1&&"^"===s[0]?"only hook such keys":"pass through such keys":"completely disabled")&&(e.$h.title=h),this.Kh(e,o,s),l.push(e.Th)):this.Kh(e,"",s)):e.Th.pattern&&l.push(e.Th));return l},i.prototype.Kh=function(t,n,e){var u=!t.Th.passKeys&&!!e;t.Th={pattern:n,passKeys:e},t.Nh=false,u&&i.jh(t)},i.prototype.uh=function(){var t,n,i,e;for(t=0,n=this.U_;t<n.length;t++)(i=n[t]).vf&&(i.Jh.value!==i.Th.pattern&&(i.Jh.value=i.Th.pattern),e=i.Th.passKeys.trim(),i.$h.value!==e&&(i.$h.value=e))},i})(_),P=R<48||devicePixelRatio<2&&R>=61?function(){var t=document.createElement("style"),n=devicePixelRatio,i=R>=61&&n>=1,e=i||R>=48?1/n:1;e=(""+(e+=999e-8)).slice(0,7).replace(/\.?0+$/,""),t.textContent=i?"input, textarea { border-width: "+e+"px; }":"* { border-width: "+e+"px !important; }",document.head.appendChild(t)}:null,location.pathname.toLowerCase().includes("/popup.html")&&Promise.all([u.r.Ma("Exclusions"),u.r.ic(1),N.Kc&&N.Kc()]).then((function(t){return function(){chrome.tabs.query({currentWindow:true,active:true},t)}})(function(n){function i(t){var n,i,e=3===T,u=e?l.q(y,d):l.Ks(y,d,U.vh(true));u&&(u=(function(t){var n,i,e,u;for((n=(t=t.trim()).startsWith("^"))&&(t=t.slice(1).trimLeft()),i=Object.create(null),e=0,u=t.split(" ");e<u.length;e++)i[u[e]]=1;return(n?"^ ":"")+Object.keys(i).sort().join(" ")})(u)),t&&(S=T>=2?u:null),T=2,n=u===S,i=!!u&&u.length>2&&"^"===u[0],p.textContent=(e?u?s("o137")+s(i?"o138":"o139"):s("o140"):s(n?"o141":"o142")+s(u?i?"o138":"o139":n?"o143":"o143_2")).replace(" to be","")+s("colon")+(u?s("NS"):""),w.className=u?"code":"fixed-width",w.textContent=u?i?u.slice(2):u:s(null!==u?"o144":"o145")+s("o146"),g.textContent=E&&!e&&n?s("o147",[s(0!==R?"o144":"o145")]):E?s("o148"):"",m.disabled=n,m.firstChild.data=s(n?"o115":"o115_2")}function e(){if(!m.disabled){var t=l.o;u.a.hs("reset silent",d.t),U.dh(),setTimeout(function(){l.o=t},50),T=3,i(true),m.firstChild.data=s("o115_3"),m.disabled=true,k=true}}function o(t,n){n&&n.preventDefault(),u.a.hs(t.toLowerCase(),d.t),window.close()}var r,c,f,a,h,l,d,v,p,m,w,g,y,b,k,S,R,T,$,j,K,D,z,A,E,L,M,U,B=n[0],W=u.a.zc(B.id),Z=t("#blocked-msg"),q=!(W||B&&B.url&&"loading"===B.status&&/^(ht|s?f)tp/.test(B.url));if(q?(r=document.body,c=document.documentElement,r.innerText="",Z.style.display="",Z.querySelector(".version").textContent=N.me.Qc,f=Z.querySelector("#refresh-after-install"),B&&B.url&&/^(ht|s?f)tp/i.test(B.url)||f.remove(),r.style.width="auto",r.appendChild(Z),c.classList.toggle("auto-dark",!!N.gc.d),c.style.height=""):O(function(t){Z.remove(),Z=null;var n=document.documentElement.classList;n.toggle("auto-dark",!!N.gc.d),n.toggle("less-motion",!!N.gc.m),t.textContent=N.me.Qc},t(".version")),(a=t(".options-link")).href!==(h=N.me.rs)&&(a.href=h),a.onclick=function(t){t.preventDefault();var n=u.Object.create(null);n.u=N.me.rs,u.a.Lr(n),window.close()},!q){for(l=u.Exclusions,d=!W||W[0].s.i&&!u.r.la.test(W[0].s.u)?{i:0,a:B.incognito,s:0,f:0,t:B.id,u:B.url}:W[0].s,v=d.i&&((u.a.zc(B.id,0)||{}).s||{}).u||"",p=t("#state-action"),m=t("#saveOptions"),g=(w=p.nextElementSibling).nextElementSibling,y=d.u,b=(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return x(n,t),n.prototype.kh=function(i,e){t.prototype.kh.call(this,n.Dh(),e)},n.prototype.Ph=function(t){if(!t)return false;var n=l.o[t];return!(1===n.t?!y.startsWith(n.v)||v&&!v.startsWith(n.v):!n.v.test(y)||v&&!n.v.test(v))},n.prototype.sh=function(e){var u,o,r,s;t.prototype.sh.call(this,e),(u=this).yh&&(u.sh=null,document.documentElement.style.height="",n.prototype.Ph=J.prototype.Ph,o=u.U_.filter(function(t){return t.vf}),T=(r=o.length>0)?2:1,r?(s=o[0].$h,i(true)):(u.kh("",false),s=u.U_[u.U_.length-1].$h),O(function(){return s.focus()}))},n.prototype.Kh=function(n,i,e){var u,o,r=n.Th.pattern===i;t.prototype.Kh.call(this,n,i,e),r||(u=l.g(i,""),o=n.Jh,(1===u.t?y.startsWith(u.v):u.v.test(y))?o.title=o.style.color="":(o.style.color="red",o.title="Red text means that the pattern does not\nmatch the current URL."))},n.Dh=function(){var t=y.startsWith("http:")?"^https?://"+y.split("/",3)[2].replace(/[.[\]]/g,"\\$&")+"/":y.startsWith(location.origin)?":vimium:/"+new URL(y).pathname.replace("/pages",""):/^[^:]+:\/\/./.test(y)&&!y.startsWith("file:")?":"+y.split("/",3).join("/")+"/":":"+y;return n.Dh=function(){return t},t},n})(J),k=true,S=null,R=-1,T=0,m.onclick=e,document.addEventListener("keyup",function(t){if(13===t.keyCode&&(t.ctrlKey||t.metaKey)&&(setTimeout(window.close,300),!k))return e()}),$=N.Sc("exclusionRules"),j=l.o=u.Object.create(null),K=l.Fs,D=0,z=$.length;D<z;D++)j[$[D].pattern]=K[D];A=2!==d.s?"Disable":"Enable",R=(E=!!(1&d.f))?d.s:-1,L=t("#toggleOnce"),M=L.nextElementSibling,O(function(){L.firstElementChild.textContent=(s(A)||A)+(E?"":s("Once")),L.onclick=o.bind(null,A),w.id="state-value",E?(M.classList.remove("hidden"),M.firstElementChild.onclick=o.bind(null,"Reset")):M.remove()}),N.gc.o||window.addEventListener("keydown",function(t){t.altKey&&(88===t.keyCode||E&&90===t.keyCode)&&!(t.shiftKey||t.ctrlKey||t.metaKey)&&(t.preventDefault(),t.stopImmediatePropagation(),o(88===t.keyCode?A:"Reset"))}),_.rh=false,U=null,(U=new b(t("#exclusionRules"),function(){if(k){k=false;var n=t("#helpSpan");n&&(n.nextElementSibling.style.display="",n.remove()),m.removeAttribute("disabled"),m.firstChild.data=s("o115_2")}i(T<2)})).oh(),window.onunload=function(){l.o=null,u.r.ic(-1)},P&&O(P)}}));